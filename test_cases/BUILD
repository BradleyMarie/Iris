load("@rules_cc//cc:defs.bzl", "cc_test")

package(default_visibility = ["//visibility:private"])

cc_test(
    name = "constructive_solid_geometry",
    srcs = ["constructive_solid_geometry.cc"],
    data = [
        "//test_results:csg_cube_sphere_difference.pfm",
        "//test_results:csg_rounded_cube.pfm",
        "//test_results:csg_sphere_intersection.pfm",
        "//test_results:csg_sphere_union.pfm",
    ],
    shard_count = 4,
    deps = [
        "//iris_advanced_toolkit:pcg_random",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:pinhole_camera",
        "//iris_physx_toolkit/bsdfs:lambertian",
        "//iris_physx_toolkit/materials:constant",
        "//iris_physx_toolkit/scenes:list",
        "//iris_physx_toolkit/shapes:constructive_solid_geometry",
        "//iris_physx_toolkit/shapes:sphere",
        "//iris_physx_toolkit:all_light_sampler",
        "//iris_physx_toolkit:color_spectra",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:point_light",
        "//iris_physx_toolkit:sample_tracer",
        "//test_util:pfm",
        "//test_util:quad",
        "@com_google_googletest//:gtest_main",
    ],
)

cc_test(
    name = "cornell_box",
    srcs = ["cornell_box.cc"],
    data = [
        "//test_results:cornell_box.pfm",
    ],
    linkstatic = 1,
    deps = [
        "//iris_advanced_toolkit:pcg_random",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:pinhole_camera",
        "//iris_physx_toolkit/bsdfs:lambertian",
        "//iris_physx_toolkit/materials:constant",
        "//iris_physx_toolkit/scenes:kd_tree",
        "//iris_physx_toolkit/shapes:triangle",
        "//iris_physx_toolkit:attenuated_reflector",
        "//iris_physx_toolkit:cie_color_integrator",
        "//iris_physx_toolkit:color_spectra",
        "//iris_physx_toolkit:constant_emissive_material",
        "//iris_physx_toolkit:interpolated_spectrum",
        "//iris_physx_toolkit:one_light_sampler",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:sample_tracer",
        "//test_util:cornell_box",
        "//test_util:pfm",
        "//test_util:quad",
        "@com_google_googletest//:gtest_main",
    ],
)

cc_test(
    name = "cornell_box_dielectric",
    srcs = ["cornell_box_dielectric.cc"],
    data = [
        "//test_results:cornell_box_with_dielectric.pfm",
    ],
    linkstatic = 1,
    deps = [
        "//iris_advanced_toolkit:pcg_random",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:pinhole_camera",
        "//iris_physx_toolkit/bsdfs:fresnel",
        "//iris_physx_toolkit/bsdfs:lambertian",
        "//iris_physx_toolkit/materials:constant",
        "//iris_physx_toolkit/scenes:kd_tree",
        "//iris_physx_toolkit/shapes:sphere",
        "//iris_physx_toolkit/shapes:triangle",
        "//iris_physx_toolkit:attenuated_reflector",
        "//iris_physx_toolkit:cie_color_integrator",
        "//iris_physx_toolkit:color_spectra",
        "//iris_physx_toolkit:constant_emissive_material",
        "//iris_physx_toolkit:interpolated_spectrum",
        "//iris_physx_toolkit:one_light_sampler",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:sample_tracer",
        "//iris_physx_toolkit:uniform_reflector",
        "//test_util:cornell_box",
        "//test_util:pfm",
        "//test_util:quad",
        "@com_google_googletest//:gtest_main",
    ],
)

cc_test(
    name = "deterministic",
    srcs = ["deterministic.cc"],
    deps = [
        "//iris_advanced_toolkit:halton_sequence",
        "//iris_advanced_toolkit:pcg_random",
        "//iris_advanced_toolkit:sobol_sequence",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:low_discrepancy_image_sampler",
        "//iris_camera_toolkit:pinhole_camera",
        "//iris_physx_toolkit/bsdfs:lambertian",
        "//iris_physx_toolkit/materials:constant",
        "//iris_physx_toolkit/scenes:kd_tree",
        "//iris_physx_toolkit/shapes:triangle",
        "//iris_physx_toolkit:attenuated_reflector",
        "//iris_physx_toolkit:cie_color_integrator",
        "//iris_physx_toolkit:constant_emissive_material",
        "//iris_physx_toolkit:interpolated_spectrum",
        "//iris_physx_toolkit:one_light_sampler",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:sample_tracer",
        "//test_util:cornell_box",
        "//test_util:equality",
        "//test_util:quad",
        "@com_google_googletest//:gtest_main",
    ],
)

cc_test(
    name = "empty_physx",
    srcs = ["empty_physx.cc"],
    data = [
        "//test_results:blank.pfm",
    ],
    deps = [
        "//iris_advanced_toolkit:pcg_random",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:pinhole_camera",
        "//iris_physx_toolkit/scenes:kd_tree",
        "//iris_physx_toolkit/scenes:list",
        "//iris_physx_toolkit:all_light_sampler",
        "//iris_physx_toolkit:color_spectra",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:sample_tracer",
        "//test_util:pfm",
        "@com_google_googletest//:gtest_main",
    ],
)

cc_test(
    name = "environmental_light",
    srcs = ["environmental_light.cc"],
    data = [
        "//test_results:blue.pfm",
    ],
    deps = [
        "//iris_advanced_toolkit:pcg_random",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:pinhole_camera",
        "//iris_physx_toolkit/scenes:list",
        "//iris_physx_toolkit:all_light_sampler",
        "//iris_physx_toolkit:color_spectra",
        "//iris_physx_toolkit:infinite_environmental_light",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:sample_tracer",
        "//test_util:pfm",
        "@com_google_googletest//:gtest_main",
    ],
)

cc_test(
    name = "single_sphere",
    srcs = ["single_sphere.cc"],
    data = [
        "//test_results:sphere_away.pfm",
        "//test_results:sphere_center.pfm",
        "//test_results:sphere_right.pfm",
        "//test_results:sphere_up.pfm",
    ],
    deps = [
        "//iris_advanced_toolkit:pcg_random",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:pinhole_camera",
        "//iris_physx_toolkit/bsdfs:lambertian",
        "//iris_physx_toolkit/materials:constant",
        "//iris_physx_toolkit/scenes:list",
        "//iris_physx_toolkit/shapes:sphere",
        "//iris_physx_toolkit:all_light_sampler",
        "//iris_physx_toolkit:color_spectra",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:point_light",
        "//iris_physx_toolkit:sample_tracer",
        "//test_util:pfm",
        "@com_google_googletest//:gtest_main",
    ],
)

cc_test(
    name = "single_triangle",
    srcs = ["single_triangle.cc"],
    data = [
        "//test_results:blank.pfm",
        "//test_results:single_emissive_triangle_xy_triangle.pfm",
        "//test_results:single_emissive_triangle_xz_triangle.pfm",
        "//test_results:single_emissive_triangle_yz_triangle.pfm",
        "//test_results:single_triangle_xy_triangle.pfm",
        "//test_results:single_triangle_xz_triangle.pfm",
        "//test_results:single_triangle_yz_triangle.pfm",
    ],
    shard_count = 42,
    deps = [
        "//iris_advanced_toolkit:pcg_random",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:orthographic_camera",
        "//iris_physx_toolkit/bsdfs:lambertian",
        "//iris_physx_toolkit/materials:constant",
        "//iris_physx_toolkit/scenes:list",
        "//iris_physx_toolkit/shapes:triangle",
        "//iris_physx_toolkit:all_light_sampler",
        "//iris_physx_toolkit:attenuated_reflector",
        "//iris_physx_toolkit:color_spectra",
        "//iris_physx_toolkit:constant_emissive_material",
        "//iris_physx_toolkit:directional_light",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:sample_tracer",
        "//test_util:pfm",
        "@com_google_googletest//:gtest_main",
    ],
)

cc_test(
    name = "teapot",
    srcs = ["teapot.cc"],
    data = [
        "//test_results:teapot_flat.pfm",
        "//test_results:teapot_smooth.pfm",
    ],
    deps = [
        "//iris_advanced_toolkit:pcg_random",
        "//iris_camera_toolkit:grid_image_sampler",
        "//iris_camera_toolkit:pinhole_camera",
        "//iris_physx_toolkit/bsdfs:lambertian",
        "//iris_physx_toolkit/materials:constant",
        "//iris_physx_toolkit/scenes:bvh",
        "//iris_physx_toolkit/scenes:kd_tree",
        "//iris_physx_toolkit/shapes:triangle_mesh",
        "//iris_physx_toolkit:all_light_sampler",
        "//iris_physx_toolkit:attenuated_reflector",
        "//iris_physx_toolkit:color_spectra",
        "//iris_physx_toolkit:path_tracer",
        "//iris_physx_toolkit:point_light",
        "//iris_physx_toolkit:sample_tracer",
        "//iris_physx_toolkit:triangle_mesh_normal_map",
        "//test_util:pfm",
        "//test_util:teapot",
        "@com_google_googletest//:gtest_main",
    ],
)
